<h2 class="mb-3"><%= training_schedule.training&.title || "タイトル未設定" %></h2>

<!-- 内容・日時・会場 -->
<div class="card mb-4">
  <div class="card-body">
    <p><strong>内容:</strong> <%= training_schedule.training&.description || "未設定" %></p>

    <p>
      <strong>日時:</strong>
      <%= training_schedule.start_time.present? ? training_schedule.start_time.strftime("%Y/%m/%d %H:%M") : "未設定" %>
      <% if training_schedule.end_time.present? %>
        ～ <%= training_schedule.end_time.strftime("%H:%M") %>
      <% end %>
    </p>

    <p><strong>会場:</strong> <%= training_schedule.room&.name || "未定" %></p>
  </div>
</div>

<!-- 講師 -->
<div class="card mb-4">
  <div class="card-body">
    <h5 class="card-title">講師</h5>
    <% if training_schedule.instructors.any? %>
      <ul class="list-group list-group-flush">
        <% training_schedule.instructors.each do |instructor| %>
         <li class="list-group-item"><%= instructor.user&.name || "未設定" %></li>
        <% end %>
      </ul>
    <% else %>
      <p class="text-muted mb-0">未定</p>
    <% end %>
  </div>
</div>

<!-- 参加者 -->
<div class="card mb-4">
  <div class="card-body">
    <h5 class="card-title">参加者</h5>
<% if training_schedule.participants.any? %>
  <ul class="list-group list-group-flush">
    <% training_schedule.participants.uniq { |p| p.id }.each do |participant| %>
      <li class="list-group-item">
        <%= participant.name.presence || "未設定" %>
      </li>
    <% end %>
  </ul>
<% else %>
  <p class="text-muted mb-0">未定</p>
<% end %>
  </div>
</div>

<!-- PDF資料 -->
<div class="card mb-4">
  <div class="card-body">
    <h5 class="card-title">研修資料</h5>

    <% training = training_schedule.training %>
    <% if training&.materials&.attached? && training.materials.any? %>
      <ul class="list-group list-group-flush">
        <% training.materials.each do |file| %>
          <li class="list-group-item d-flex justify-content-between align-items-center">
            <span><%= file.filename.to_s %></span>

            <div class="btn-group btn-group-sm" role="group">
              <!-- ブラウザで開く -->
              <%= link_to "開く", rails_blob_path(file, disposition: "inline"),
                          target: "_blank", class: "btn btn-outline-primary" %>

              <!-- ダウンロード -->
              <%= link_to "ダウンロード", rails_blob_path(file, disposition: "attachment"),
                          class: "btn btn-outline-success" %>
            </div>
          </li>
        <% end %>
      </ul>
    <% else %>
      <p class="text-muted mb-0">
        <% if training.nil? %>
          研修情報が未設定です
        <% else %>
          資料はまだアップロードされていません
        <% end %>
      </p>
    <% end %>
  </div>
</div>

